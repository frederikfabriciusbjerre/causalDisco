% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tpc.R
\name{tpc}
\alias{tpc}
\title{Perform causal discovery using the temporal PC algorithm (TPC)}
\usage{
tpc(
  data = NULL,
  knowledge = NULL,
  order = NULL,
  sparsity = 10^(-1),
  test = regTest,
  suffStat = NULL,
  method = "stable.fast",
  methodNA = "none",
  methodOri = "conservative",
  output = "discography",
  varnames = NULL,
  ...
)
}
\arguments{
\item{data}{A data frame with the observed variables. Columns are variables.
When using the deprecated \code{order} argument, variables should be
prefixed with their period name (see examples). When using
\code{knowledge}, prefixes are not required.}

\item{knowledge}{A \code{knowledge} object created with \code{knowledge()},
encoding tier assignments and optional forbidden/required edges. This is
the preferred way to provide temporal background knowledge.}

\item{order}{A character vector of period prefixes in temporal order.
Deprecated; use \code{knowledge} instead. If supplied, it is converted
internally to tier knowledge using \code{tidyselect::starts_with()} for
each prefix.}

\item{sparsity}{The sparsity level used as the per-test significance
threshold for conditional independence testing.}

\item{test}{A conditional independence test. The default \code{regTest}
uses a regression-based information-loss test. Another available option is
\code{corTest} which tests for vanishing partial correlations. User-supplied
functions may also be used; see details for the required interface.}

\item{suffStat}{A sufficient statistic. If supplied, it is passed directly
to the test and no statistics are computed from \code{data}. Its structure
depends on the chosen \code{test}.}

\item{method}{Skeleton construction method, one of \code{"stable"},
\code{"original"}, or \code{"stable.fast"} (default). See
\code{\link[pcalg]{skeleton}} for details.}

\item{methodNA}{Handling of missing values, one of \code{"none"} (default;
error on any \code{NA}), \code{"cc"} (complete-case analysis), or
\code{"twd"} (test-wise deletion).}

\item{methodOri}{Conflict-handling method when orienting edges.
Currently only the conservative method is available.}

\item{output}{One of \code{"tpdag"}, \code{"tskeleton"}, \code{"pcAlgo"},
or \code{"discography"}. If \code{"tskeleton"}, return the temporal
skeleton without directions. If \code{"tpdag"} (default), return a
temporal partially directed acyclic graph (TPDAG). If \code{"pcAlgo"},
return a \code{\link[pcalg]{pcAlgo-class}} object for compatibility with
\pkg{pcalg}. If \code{"discography"}, return a tidy tibble of edges via
\code{discography()}.}

\item{varnames}{Character vector of variable names. Only needed when
\code{data} is not supplied and all information is passed via
\code{suffStat}.}

\item{...}{Additional arguments passed to
\code{\link[pcalg]{skeleton}} during skeleton construction.}
}
\value{
If \code{output = "tpdag"} or \code{"tskeleton"}, an S3 list with entries
\code{$tamat} (temporal adjacency matrix), \code{$psi} (sparsity level),
and \code{$ntests} (number of tests run). If \code{output = "pcAlgo"}, a
\code{\link[pcalg]{pcAlgo-class}} object. If \code{output = "discography"},
a tibble with columns \code{from}, \code{to}, and \code{edge_type}.
}
\description{
Run a tier-aware variant of the PC algorithm that respects background
knowledge about a partial temporal order. Supply the temporal order via a
\code{knowledge} object. For backward compatibility, you may still pass
\code{order}, but that interface is deprecated and will be removed in a
future release.
}
\details{
Any independence test implemented in \pkg{pcalg} may be used; see
\code{\link[pcalg]{pc}}. When \code{methodNA = "twd"}, test-wise deletion is
performed: for \code{corTest}, each pairwise correlation uses complete cases;
for \code{regTest}, each conditional test performs its own deletion. If you
supply a user-defined \code{test}, you must also provide \code{suffStat}.

Temporal or tiered knowledge enters in two places:
\itemize{
\item during skeleton estimation, candidate conditioning sets are pruned so
they do not contain variables that are strictly after both endpoints;
\item during orientation, any cross-tier edge is restricted to point
forward in time.
}
The \code{order} argument is deprecated. If provided, it is converted to a
\code{knowledge} object by assigning variables to tiers using
\code{tidyselect::starts_with()} for each prefix.
}
\examples{
# Using knowledge (preferred)
data(tpcExample)
kn <- knowledge(
  tpcExample,
  tier(
    child ~ tidyselect::starts_with("child"),
    youth ~ tidyselect::starts_with("youth"),
    oldage ~ tidyselect::starts_with("oldage")
  )
)
tpc(tpcExample, knowledge = kn, sparsity = 0.01)

# Deprecated: using order prefixes (will warn)
testthat::expect_warning(
  tpc(tpcExample, order = c("child", "youth", "oldage"), sparsity = 0.01)
)

}
